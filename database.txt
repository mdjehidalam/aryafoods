DATABASE: AryaFoods
1. User
2. Restaurant
3. Menu
4. orderitems
5. orders
6. orderHistory

CREATE TABLE user (
    userid INT NOT NULL AUTO_INCREMENT,
    NAME VARCHAR(40),
    email VARCHAR(40) NOT NULL,
    PhoneNo VARCHAR(20) NOT NULL,
    Address VARCHAR(100),
    username VARCHAR(20) NOT NULL,
    password VARCHAR(100) NOT NULL,
    role ENUM('CUSTOMER','RESTAURANT_OWNER','DELIVERY_BOY','SYSTEM_ADMIN'),
    createDate DATETIME DEFAULT CURRENT_TIMESTAMP,
    lastLoginDate DATETIME DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY (userid)
);
CREATE TABLE restaurant (
    restaurantId INT NOT NULL AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL,
    imagePath VARCHAR(200),
    rating DECIMAL(2,1) DEFAULT 0.0,
    eta INT,
    cuisineType VARCHAR(100),
    address VARCHAR(200),
    isActive TINYINT(1) DEFAULT 1,
    restaurantOwnerId INT,
    PRIMARY KEY (restaurantId),
    KEY restaurantOwnerId (restaurantOwnerId),
    CONSTRAINT fk_restaurant_owner FOREIGN KEY (restaurantOwnerId) REFERENCES user(userid)
        ON DELETE SET NULL
        ON UPDATE CASCADE
);

CREATE TABLE menu (
    menuId INT NOT NULL AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL,
    price DECIMAL(10,2) NOT NULL,
    description TEXT,
    imagePath VARCHAR(200),
    isAvailable TINYINT(1) DEFAULT 1,
    restaurantId INT,
    rating DECIMAL(2,1) DEFAULT 0.0,
    PRIMARY KEY (menuId),
    KEY restaurantId (restaurantId),
    CONSTRAINT fk_menu_restaurant FOREIGN KEY (restaurantId) REFERENCES restaurant(restaurantId)
        ON DELETE CASCADE
        ON UPDATE CASCADE
);


CREATE TABLE orderItems (
    orderItemId INT NOT NULL AUTO_INCREMENT,
    userId INT NOT NULL,
    menuId INT NOT NULL,
    name VARCHAR(150) NOT NULL,
    quantity INT NOT NULL,
    rating DECIMAL(2,1),
    price DECIMAL(10,2) NOT NULL,
    restaurantId INT,
    PRIMARY KEY (orderItemId),
    KEY userId (userId),
    KEY menuId (menuId),
    KEY restaurantId (restaurantId),
    CONSTRAINT fk_orderItems_user FOREIGN KEY (userId) REFERENCES user(userid)
        ON DELETE CASCADE
        ON UPDATE CASCADE,
    CONSTRAINT fk_orderItems_menu FOREIGN KEY (menuId) REFERENCES menu(menuId)
        ON DELETE CASCADE
        ON UPDATE CASCADE,
    CONSTRAINT fk_orderItems_restaurant FOREIGN KEY (restaurantId) REFERENCES restaurant(restaurantId)
        ON DELETE SET NULL
        ON UPDATE CASCADE
);

CREATE TABLE orders (
    orderId INT NOT NULL AUTO_INCREMENT,
    restaurantId INT NOT NULL,
    userId INT NOT NULL,
    totalAmount DECIMAL(10,2) NOT NULL,
    modeOfPayment ENUM('CASH','CARD','UPI','WALLET','NET_BANKING') NOT NULL,
    status ENUM('PENDING','DISPATCH','COMPLETED','CANCELLED') NOT NULL,
    orderTime TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    menuId INT,
    PRIMARY KEY (orderId),
    KEY restaurantId (restaurantId),
    KEY userId (userId),
    KEY menuId (menuId),
    CONSTRAINT fk_orders_user FOREIGN KEY (userId) REFERENCES user(userid)
        ON DELETE CASCADE
        ON UPDATE CASCADE,
    CONSTRAINT fk_orders_restaurant FOREIGN KEY (restaurantId) REFERENCES restaurant(restaurantId)
        ON DELETE CASCADE
        ON UPDATE CASCADE,
    CONSTRAINT fk_orders_menu FOREIGN KEY (menuId) REFERENCES menu(menuId)
        ON DELETE SET NULL
        ON UPDATE CASCADE
);

CREATE TABLE orderHistory (
    orderHistoryId INT NOT NULL AUTO_INCREMENT,
    orderId INT NOT NULL,
    userId INT NOT NULL,
    PRIMARY KEY (orderHistoryId),
    KEY orderId_idx (orderId),
    KEY userId_idx (userId),
    CONSTRAINT fk_orderHistory_order FOREIGN KEY (orderId) REFERENCES orders(orderId)
        ON DELETE CASCADE
        ON UPDATE CASCADE,
    CONSTRAINT fk_orderHistory_user FOREIGN KEY (userId) REFERENCES user(userid)
        ON DELETE CASCADE
        ON UPDATE CASCADE
);
